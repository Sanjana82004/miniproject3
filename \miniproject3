package miniproject3;

import java.util.*;

class Student {
    int eno;
    String name;
    String branch;
    String sem;
    double percentage;

    Student(int eno, String name, String branch, String sem, double percentage) {
        this.eno = eno;
        this.name = name;
        this.branch = branch;
        this.sem = sem;
        this.percentage = percentage;
    }

    @Override
    public String toString() {
        return eno + " | " + name + " | " + branch + " | " + sem + " | " + percentage;
    }
}

public class StudentManagementSystem {

    static ArrayList<Student> students = new ArrayList<>();
    static Scanner sc = new Scanner(System.in);

    public static void main(String[] args) {

        login();

        int choice;
        do {
            System.out.println("\n--- Student Management Menu ---");
            System.out.println("1. Add Student");
            System.out.println("2. Display All Students");
            System.out.println("3. Search Student by Eno");
            System.out.println("4. Update Student Branch");
            System.out.println("5. Delete Student by Eno");
            System.out.println("6. Display Sorted Students");
            System.out.println("7. Exit");
            System.out.print("Enter choice: ");
            choice = sc.nextInt();

            switch (choice) {
                case 1 -> addStudent();
                case 2 -> displayStudents();
                case 3 -> searchStudent();
                case 4 -> updateBranch();
                case 5 -> deleteStudent();
                case 6 -> sortStudents();
                case 7 -> System.out.println("Program exited successfully.");
                default -> System.out.println("Invalid choice!");
            }
        } while (choice != 7);
    }

    //  Login System
    static void login() {
        String user, pass;
        do {
            System.out.print("Username: ");
            user = sc.next();
            System.out.print("Password: ");
            pass = sc.next();
        } while (!user.equals("admin") || !pass.equals("admin123"));

        System.out.println("Login Successful!");
    }

    //  Add Student
    static void addStudent() {
        try {
            System.out.print("Enter Eno: ");
            int eno = sc.nextInt();

            for (Student s : students) {
                if (s.eno == eno) {
                    throw new Exception("Error: Student Eno must be unique!");
                }
            }

            sc.nextLine();
            System.out.print("Enter Name: ");
            String name = sc.nextLine();

            System.out.print("Enter Branch: ");
            String branch = sc.nextLine();
            if (branch.isEmpty())
                throw new Exception("Error: Branch cannot be empty!");

            System.out.print("Enter Semester: ");
            String sem = sc.nextLine();
            if (sem.isEmpty())
                throw new Exception("Error: Semester cannot be empty!");

            System.out.print("Enter Percentage: ");
            double per = sc.nextDouble();
            if (per <= 0)
                throw new Exception("Error: Percentage must be positive!");

            students.add(new Student(eno, name, branch, sem, per));
            System.out.println("Student added successfully!");

        } catch (Exception e) {
            System.out.println(e.getMessage());
        }
    }

    //  Display Students
    static void displayStudents() {
        if (students.isEmpty()) {
            System.out.println("No student records found!");
            return;
        }
        for (Student s : students) {
            System.out.println(s);
        }
    }

    //  Search Student
    static void searchStudent() {
        System.out.print("Enter Eno: ");
        int eno = sc.nextInt();

        for (Student s : students) {
            if (s.eno == eno) {
                System.out.println(s);
                return;
            }
        }
        System.out.println("Student not found!");
    }

    // Update Branch
    static void updateBranch() {
        System.out.print("Enter Eno: ");
        int eno = sc.nextInt();
        sc.nextLine();

        for (Student s : students) {
            if (s.eno == eno) {
                System.out.print("Enter new Branch: ");
                String branch = sc.nextLine();
                if (branch.isEmpty()) {
                    System.out.println("Error: Branch cannot be empty!");
                    return;
                }
                s.branch = branch;
                System.out.println("Branch updated successfully!");
                return;
            }
        }
        System.out.println("Student not found!");
    }

    //  Delete Student
    static void deleteStudent() {
        System.out.print("Enter Eno: ");
        int eno = sc.nextInt();

        Iterator<Student> it = students.iterator();
        while (it.hasNext()) {
            if (it.next().eno == eno) {
                it.remove();
                System.out.println("Student deleted successfully!");
                return;
            }
        }
        System.out.println("Student not found!");
    }

    // sort students
    static void sortStudents() {
        students.sort(Comparator.comparing(s -> s.name));
        displayStudents();
    }
}
